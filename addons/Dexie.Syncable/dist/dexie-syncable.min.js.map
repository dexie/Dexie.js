{"version":3,"sources":["dexie-syncable.js"],"names":["global","factory","exports","module","require","define","amd","globalThis","self","Dexie","Syncable","this","_interopDefaultLegacy","e","default","Dexie__default","Promise$3","Promise","initPersistedContext","node","PersistedContext","prototype","save","vip","nodeID","otherProps","extend","CREATE","UPDATE","DELETE","initApplyChanges","db","changes","collectedChanges","forEach","change","_a","hasOwnProperty","table","type","push","table_names","Object","keys","tables","map","transaction","table_name","specifyKeys","schema","primKey","keyPath","createChangesToApply","deleteChangesToApply","updateChangesToApply","length","bulkPut","c","obj","key","undefined","where","anyOf","raw","each","cursor","primaryKey","then","objsToPut","filter","curr","mods","setByKeyPath","bulkUpdate","bulkDelete","getBaseRevisionAndMaxClientRevision","remoteBaseRevisions","maxClientRevision","Infinity","remoteBaseRevision","i","myRevision","local","remote","mergeChange","prevChange","nextChange","clonedChange","deepClone","combineCreateAndUpdate","hadParentPath","parentPath","indexOf","substr","subPath","combineUpdateAndUpdate","initGetLocalChangesForNode","hasMoreToGive","partialsThreshold","MAX_CHANGES_PER_CHUNK","cb","getChangesSinceRevision","revision","maxChanges","maxRevision","changeSet","numChanges","partial","ignoreSource","id","nextRevision","_changes","between","until","rev","source","changeToSend","mergedChange","initGetChangesSinceRevision","getTableObjectsAsChanges","state","collection","limitReached","item","currentTable","value","currentKey","dbUploadState","tablesToUpload","shift","orderBy","brmcr","localBaseRevision","additionalChanges","nodeModificationsOnAck","concat","initGetTableObjectsAsChanges","observable","name","resolve","last","lastChange","above","Statuses","ERROR","OFFLINE","CONNECTING","ONLINE","SYNCING","ERROR_WILL_RETRY","Promise$2","initConnectProtocol","protocolInstance","dbAliveID","options","rejectConnectPromise","enqueue","context","fn","instanceID","_enqueue","ongoingOperation","ignoreTransaction","finally","_localSyncNode","reject","DatabaseClosedError","isOpen","initEnqueue","stillAlive","activePeer","connectedContinuation","getLocalChangesForNode","url","changeStatusTo","newStatus","status","syncable","on","statusChanged","fire","broadcastMessage","catch","isNaN","doSync","getLocalChangesForNode_autoAckIfEmpty","sendChangesToProvider","finalSyncPromise","p","err","asap","sync","syncContext","appliedRemoteRevision","applyRemoteChanges","onChangesAccepted","continuation","onError","ex","error","again","setTimeout","abortTheProvider","disconnect","continueSendingChanges","autoAck","remoteChanges","remoteRevision","saveToUncommittedChanges","_uncommittedChanges","bulkAdd","changeWithNodeId","initSaveToUncommittedChanges","finallyCommitAllChanges","applyChanges","tablesToIncludeInTrans","trans","currentTransaction","localRevisionBeforeChanges","equals","toArray","uncommittedChanges","delete","currentLocalRevision","splice","console","warn","stack","initFinallyCommitAllChanges","react","changesWaiting","isWaitingForServer","onChanges","reactToChanges","message","unsubscribe","continueUsingReactPattern","syncAgain","continueUsingPollPattern","initConnectFn","activePeers","protocolName","existingPeer","peer","diffObject","getObjectDiff","syncOptions","execConnect","connectPromise","connectProtocol","_syncNodes","Error","equalsIgnoreCase","first","syncProtocol","put","SyncNode","lastHeartBeat","Date","now","PersistedContext_1","initialUpload","toCollection","lastKey","currentRevision","add","initGetOrCreateSyncNode","getOrCreateSyncNode","disconnected","Events","pos","override","Promise$1","Observable","test","version","connectFn","syncableConnect","connect","isMaster","masterNode","sendMessage","wantReply","hasBeenClosed","hasFailed","InvalidStateError","get","open","initSyncableConnect","msg","weBecameMaster","connectedRemoteNodes","all","and","getStatus","getOptions","list","a","modify","registeredProtocols","nodeIDsToDelete","nodes","nodeIDs","deleteOldChanges","unsyncedChanges","close","origClose","apply","arguments","defineProperty","enumerable","configurable","writable","_this","StatusTexts","-1","0","1","2","3","4","registerSyncProtocol","addons"],"mappings":"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"}